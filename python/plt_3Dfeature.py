import torch
import numpy as np
x_tm =torch.rand(1,7,7)
x_rm = torch.rand(1,7,7)
z_m=torch.tensor([[[0.1617, 0.1228, 0.1035, 0.1004, 0.1029, 0.1025, 0.1011, 0.0988,
          0.0987, 0.0978, 0.0977, 0.0983, 0.0986, 0.1002, 0.1063, 0.1088,
          0.1065, 0.1004, 0.0987, 0.1012, 0.1036, 0.1025, 0.1017, 0.1029,
          0.1070, 0.1069, 0.1164, 0.1933],
         [0.1177, 0.1362, 0.1369, 0.1246, 0.1288, 0.1218, 0.1152, 0.1094,
          0.1061, 0.1079, 0.1055, 0.1040, 0.1039, 0.1157, 0.1194, 0.1207,
          0.1209, 0.1183, 0.1228, 0.1087, 0.1160, 0.1169, 0.1194, 0.1163,
          0.1258, 0.1211, 0.1225, 0.1192],
         [0.1026, 0.1237, 0.1278, 0.1199, 0.1353, 0.1191, 0.1087, 0.1049,
          0.1023, 0.1016, 0.0967, 0.0996, 0.1101, 0.1261, 0.1243, 0.1240,
          0.1253, 0.1259, 0.1291, 0.1250, 0.1271, 0.1207, 0.1217, 0.1305,
          0.1222, 0.1135, 0.1070, 0.1013],
         [0.0996, 0.1172, 0.1186, 0.1310, 0.1162, 0.1094, 0.1013, 0.1032,
          0.0984, 0.1009, 0.1003, 0.1083, 0.1218, 0.1343, 0.1189, 0.1271,
          0.1160, 0.1099, 0.1195, 0.1022, 0.1033, 0.1125, 0.1146, 0.1074,
          0.1203, 0.1046, 0.0992, 0.0985],
         [0.1022, 0.1204, 0.1208, 0.1360, 0.1162, 0.1061, 0.1032, 0.1052,
          0.1058, 0.1296, 0.1073, 0.1069, 0.1202, 0.1339, 0.1132, 0.1179,
          0.1104, 0.1076, 0.1099, 0.1043, 0.1041, 0.1197, 0.1318, 0.1171,
          0.1224, 0.1083, 0.1014, 0.1011],
         [0.1005, 0.1185, 0.1312, 0.1308, 0.1207, 0.1082, 0.1057, 0.1034,
          0.1090, 0.1219, 0.1213, 0.1270, 0.1267, 0.1144, 0.1097, 0.1169,
          0.1120, 0.1184, 0.1142, 0.1076, 0.1147, 0.1272, 0.1327, 0.1296,
          0.1158, 0.1228, 0.0998, 0.1007],
         [0.1007, 0.1162, 0.1305, 0.1170, 0.1191, 0.1115, 0.1061, 0.1088,
          0.1049, 0.1246, 0.1276, 0.1248, 0.1226, 0.1006, 0.1216, 0.1132,
          0.1201, 0.1119, 0.1135, 0.1038, 0.1169, 0.1227, 0.1261, 0.1371,
          0.1146, 0.1107, 0.1006, 0.1002],
         [0.1034, 0.1276, 0.1230, 0.1157, 0.1234, 0.1180, 0.0982, 0.1093,
          0.1191, 0.1367, 0.1345, 0.1224, 0.1069, 0.1042, 0.1109, 0.1193,
          0.1110, 0.1024, 0.1151, 0.1045, 0.1128, 0.1335, 0.1232, 0.1237,
          0.1141, 0.1165, 0.1027, 0.1032],
         [0.1005, 0.1272, 0.1249, 0.1106, 0.1377, 0.1358, 0.1032, 0.0969,
          0.1026, 0.1141, 0.1140, 0.1150, 0.0992, 0.1065, 0.1047, 0.1049,
          0.1079, 0.1077, 0.1197, 0.1126, 0.1191, 0.1229, 0.1273, 0.1157,
          0.1137, 0.1121, 0.1024, 0.1010],
         [0.1022, 0.1195, 0.1311, 0.1337, 0.1311, 0.1327, 0.1004, 0.1055,
          0.1077, 0.1116, 0.1041, 0.1100, 0.0983, 0.1011, 0.1060, 0.1013,
          0.1067, 0.1093, 0.1201, 0.1141, 0.0999, 0.1080, 0.1148, 0.1056,
          0.1131, 0.1060, 0.0960, 0.1009],
         [0.1041, 0.1083, 0.1289, 0.1115, 0.1155, 0.1142, 0.1121, 0.1074,
          0.1002, 0.1140, 0.1041, 0.0982, 0.1095, 0.1049, 0.1056, 0.1097,
          0.1158, 0.1171, 0.1169, 0.1130, 0.1079, 0.1037, 0.0996, 0.1091,
          0.1120, 0.0919, 0.0956, 0.1016],
         [0.1023, 0.1094, 0.1050, 0.1096, 0.1089, 0.1087, 0.1054, 0.1026,
          0.1140, 0.1282, 0.1093, 0.1089, 0.1179, 0.1147, 0.1282, 0.1272,
          0.1188, 0.1226, 0.1141, 0.1235, 0.1152, 0.1041, 0.0990, 0.1023,
          0.0947, 0.0935, 0.1003, 0.1030],
         [0.1006, 0.1134, 0.1187, 0.1060, 0.1061, 0.1157, 0.0986, 0.1054,
          0.1083, 0.1189, 0.0976, 0.1134, 0.1129, 0.1212, 0.1337, 0.1327,
          0.1172, 0.1189, 0.1337, 0.1161, 0.1109, 0.1076, 0.0963, 0.0921,
          0.0895, 0.0922, 0.1007, 0.1018],
         [0.1021, 0.1129, 0.1161, 0.1112, 0.1100, 0.1085, 0.1061, 0.1127,
          0.1147, 0.1095, 0.1068, 0.1117, 0.1230, 0.1290, 0.1354, 0.1426,
          0.1275, 0.1285, 0.1210, 0.1179, 0.1175, 0.0986, 0.0974, 0.0980,
          0.0902, 0.0905, 0.0953, 0.1010],
         [0.1040, 0.1171, 0.1150, 0.1063, 0.1073, 0.1146, 0.1038, 0.1117,
          0.1140, 0.1104, 0.1071, 0.1113, 0.1374, 0.1160, 0.1261, 0.1321,
          0.1335, 0.1205, 0.1362, 0.1342, 0.1399, 0.1075, 0.1080, 0.0904,
          0.0912, 0.0955, 0.0985, 0.1009],
         [0.0985, 0.1174, 0.1121, 0.1075, 0.1036, 0.0989, 0.0977, 0.1061,
          0.1024, 0.1099, 0.1130, 0.1189, 0.1385, 0.1140, 0.1294, 0.1242,
          0.1279, 0.1230, 0.1417, 0.1162, 0.1260, 0.1066, 0.1004, 0.0900,
          0.0920, 0.0940, 0.0939, 0.1028],
         [0.0987, 0.1082, 0.1039, 0.1003, 0.1055, 0.0943, 0.0921, 0.0944,
          0.1056, 0.1059, 0.1101, 0.1158, 0.1338, 0.1233, 0.1285, 0.1365,
          0.1320, 0.1267, 0.1222, 0.1298, 0.1203, 0.1082, 0.0972, 0.1003,
          0.0918, 0.0965, 0.1000, 0.1015],
         [0.0986, 0.0978, 0.0934, 0.0932, 0.0920, 0.0888, 0.0915, 0.0960,
          0.1041, 0.1188, 0.1154, 0.1143, 0.1284, 0.1470, 0.1369, 0.1319,
          0.1243, 0.1166, 0.1134, 0.1300, 0.1229, 0.1175, 0.1080, 0.0937,
          0.0943, 0.0950, 0.1004, 0.1050],
         [0.0969, 0.0975, 0.0998, 0.0890, 0.0884, 0.0926, 0.0991, 0.0964,
          0.1064, 0.1188, 0.1123, 0.1217, 0.1241, 0.1315, 0.1250, 0.1262,
          0.1261, 0.1197, 0.1139, 0.1271, 0.1184, 0.1189, 0.1147, 0.1001,
          0.0972, 0.0992, 0.1126, 0.1074],
         [0.0982, 0.1002, 0.0981, 0.0905, 0.0914, 0.0977, 0.0925, 0.0960,
          0.1047, 0.1261, 0.1047, 0.1198, 0.1217, 0.1223, 0.1196, 0.1149,
          0.1297, 0.1144, 0.1085, 0.1099, 0.1199, 0.1246, 0.1196, 0.1050,
          0.0996, 0.1012, 0.1106, 0.1080],
         [0.0981, 0.1009, 0.1000, 0.0922, 0.0967, 0.0967, 0.0983, 0.0931,
          0.1116, 0.1378, 0.1052, 0.1048, 0.1148, 0.1181, 0.1234, 0.1299,
          0.1267, 0.1078, 0.1036, 0.1186, 0.1247, 0.1285, 0.1208, 0.1117,
          0.0987, 0.1016, 0.1117, 0.1084],
         [0.0984, 0.1058, 0.1064, 0.1086, 0.1198, 0.0958, 0.1096, 0.0933,
          0.1021, 0.1141, 0.1040, 0.1032, 0.1161, 0.1165, 0.1237, 0.1178,
          0.1204, 0.1186, 0.1122, 0.1234, 0.1206, 0.1382, 0.1073, 0.1183,
          0.0972, 0.0983, 0.1225, 0.1104],
         [0.0981, 0.1029, 0.1125, 0.1064, 0.1243, 0.1013, 0.0999, 0.0987,
          0.1057, 0.1057, 0.1121, 0.1141, 0.1162, 0.1169, 0.1303, 0.1271,
          0.1202, 0.1156, 0.1108, 0.1211, 0.1229, 0.1314, 0.1092, 0.1118,
          0.0978, 0.1078, 0.1283, 0.1088],
         [0.0981, 0.1056, 0.1163, 0.1162, 0.1340, 0.0996, 0.0920, 0.1018,
          0.1131, 0.1414, 0.1105, 0.1101, 0.1180, 0.1259, 0.1311, 0.1532,
          0.1208, 0.1199, 0.1187, 0.1147, 0.1156, 0.1235, 0.1256, 0.1169,
          0.1144, 0.1000, 0.1179, 0.1051],
         [0.0991, 0.1019, 0.1073, 0.1070, 0.1067, 0.1043, 0.1104, 0.0986,
          0.1204, 0.1410, 0.1007, 0.1072, 0.1097, 0.1113, 0.1208, 0.1193,
          0.1194, 0.1305, 0.1285, 0.1158, 0.1270, 0.1426, 0.1108, 0.1145,
          0.1048, 0.1004, 0.0964, 0.1024],
         [0.0993, 0.1078, 0.1064, 0.1054, 0.1072, 0.1102, 0.1064, 0.1084,
          0.1085, 0.1106, 0.1086, 0.1115, 0.1162, 0.1074, 0.1049, 0.1199,
          0.1195, 0.1186, 0.1236, 0.1180, 0.1302, 0.1361, 0.1118, 0.1177,
          0.1233, 0.1055, 0.1033, 0.1047],
         [0.1058, 0.1079, 0.1024, 0.0947, 0.0923, 0.0987, 0.1075, 0.1028,
          0.1058, 0.1012, 0.0919, 0.1049, 0.1055, 0.0980, 0.1093, 0.1105,
          0.1220, 0.1310, 0.1392, 0.1218, 0.1284, 0.1163, 0.1167, 0.1309,
          0.1283, 0.1104, 0.1127, 0.1101],
         [0.1426, 0.1096, 0.1084, 0.1041, 0.1022, 0.1073, 0.1105, 0.1081,
          0.1023, 0.1053, 0.1066, 0.1059, 0.1050, 0.1066, 0.1110, 0.1118,
          0.1135, 0.1245, 0.1278, 0.1200, 0.1201, 0.1156, 0.1101, 0.1178,
          0.1128, 0.1116, 0.1170, 0.1354]]])
cc = z_m.numpy()
#cc = z_m.numpy()
print(cc.shape)
bb = x_tm.numpy()
rr = x_rm.numpy()
c_size = cc.shape
b_size = bb.shape
r_size = rr.shape
cc = cc.reshape(c_size[1],c_size[2])
bb = bb.reshape(b_size[1],b_size[2])
rr = rr.reshape(r_size[1],r_size[2])
print(cc)
c_size = cc.shape
b_size = bb.shape
r_size = rr.shape
x=np.arange(0,c_size[0],1)  
y=np.arange(0,c_size[1],1)

from scipy import interpolate
f = interpolate.interp2d(x,y,cc,kind='cubic')    
x = np.arange(0,c_size[0],2.8) 
y = np.arange(0,c_size[1],2.8)
Z = f(x,y)



X,Y=np.meshgrid(x,y)  
import matplotlib as mpl
from mpl_toolkits.mplot3d import Axes3D
    #import numpy as np
import matplotlib.pyplot as plt
fig = plt.figure() 
ax = fig.add_subplot(111, projection='3d', proj_type='ortho')
ax.plot_wireframe(X, Y, Z, cmap='rainbow', alpha=1,linewidth=1)
#ax.plot_surface(X,Y,Z,rstride=1,cstride=1, cmap=plt.cm.coolwarm)
#ax.legend()
ax.set_xlabel('Y')
ax.set_ylabel('X')
ax.set_zlabel('Z')
plt.show()

